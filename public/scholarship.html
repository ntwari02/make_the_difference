<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Scholarships - MBAPE Global</title>
  <meta name="description" content="Discover scholarship opportunities to fund your education with MBAPE Global">
  <meta name="keywords" content="scholarships, education funding, study abroad, financial aid">

  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Raleway:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            'roboto': ['Roboto', 'sans-serif'],
            'raleway': ['Raleway', 'sans-serif'],
            'inter': ['Inter', 'sans-serif'],
          },
          colors: {
            primary: {
              100: '#dbeafe',
              500: '#3b82f6',
              600: '#2563eb',
              700: '##1f2937',
              900: '#1e3a8a'
            },
            dark: {
              800: '#1e293b',
              900: '#0f172a',
            }
          }
        }
      }
    }
  </script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    /* Dark mode transitions */
    * {
      transition-property: color, background-color, border-color;
      transition-duration: 300ms;
    }

    /* Mobile menu styles */
    .mobile-nav-link {
      display: block;
      width: 100%;
      color: #374151;
      font-weight: 500;
      font-size: 1rem;
      padding: 0.75rem 1rem;
      border-radius: 0.375rem;
      transition: all 0.3s ease;
    }

    .dark .mobile-nav-link {
      color: #D1D5DB;
    }

    .mobile-nav-link:hover {
      background-color: #3B82F6;
      color: white;
    }

    /* Mobile menu animation */
    #mobile-menu {
      transition: all 0.3s ease-in-out;
    }

    #mobile-menu.show {
      opacity: 1 !important;
      pointer-events: auto !important;
    }

    #mobile-menu.show .transform {
      transform: translateX(0) !important;
    }

    /* Active link styles */
    .nav-link.active,
    .mobile-nav-link.active {
      background-color: #3B82F6;
      color: white;
    }

    /* Loading state */
    .loading {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }

    .loaded {
      opacity: 1;
    }

    /* Form input focus styles */
    input:focus, textarea:focus {
      outline: none;
      border-color: #3B82F6;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
    }

    /* Dark mode specific styles */
    .dark input:focus,
    .dark textarea:focus {
      border-color: #3B82F6;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
    }

    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }
  </style>
  <link rel="prefetch" href="home.html">
  <link rel="prefetch" href="dashboard.html">
  <link rel="prefetch" href="admin_dashboard.html">
  <link rel="prefetch" href="login.html">
  <link rel="prefetch" href="signup.html">
</head>

<body class="font-roboto text-base text-gray-700 dark:bg-gray-900 dark:text-gray-300 transition-colors duration-300">
  <div id="navbar-container"></div>

  <main class="container mx-auto px-4 pt-20">
    <section class="py-16">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Available Scholarships</h2>
        <p class="text-lg text-gray-600 dark:text-gray-400">Discover opportunities to fund your education and achieve your academic goals.</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="bg-white dark:bg-dark-800 p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
          <div class="bg-primary-500 text-white p-3 rounded-full w-12 h-12 flex items-center justify-center mb-4">
            <i class="bi bi-trophy-fill text-xl"></i>
          </div>
          <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Global Leadership Scholarship</h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">This scholarship is awarded to exceptional students who have shown leadership qualities in their community. Apply today and unlock your future in global leadership.</p>
          <a href="#application-form" class="inline-block bg-primary-500 text-white px-6 py-2 rounded hover:bg-primary-600 transition-all duration-300">Apply Now</a>
        </div>

        <div class="bg-white dark:bg-dark-800 p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
          <div class="bg-primary-500 text-white p-3 rounded-full w-12 h-12 flex items-center justify-center mb-4">
            <i class="bi bi-robot text-xl"></i>
          </div>
          <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">STEM Research Scholarship</h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">Designed for students pursuing degrees in Science, Technology, Engineering, or Mathematics, this scholarship aims to promote research and innovation.</p>
          <a href="#application-form" class="inline-block bg-primary-500 text-white px-6 py-2 rounded hover:bg-primary-600 transition-all duration-300">Apply Now</a>
        </div>

        <div class="bg-white dark:bg-dark-800 p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
          <div class="bg-primary-500 text-white p-3 rounded-full w-12 h-12 flex items-center justify-center mb-4">
            <i class="bi bi-people-fill text-xl"></i>
          </div>
          <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Community Service Scholarship</h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">For students who have made a significant impact in their community through volunteer work and social initiatives.</p>
          <a href="#application-form" class="inline-block bg-primary-500 text-white px-6 py-2 rounded hover:bg-primary-600 transition-all duration-300">Apply Now</a>
        </div>
      </div>
    </section>

    <section class="py-16 bg-gray-50 dark:bg-dark-900">
      <div class="container mx-auto px-4 text-center">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Scholarship Assistance</h2>
        <p class="text-lg text-gray-600 dark:text-gray-400 mb-12">
          We are dedicated to helping students secure the financial aid they need to achieve their academic dreams. Our expert team provides personalized guidance to help you find the best scholarships suited to your needs.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="bg-white dark:bg-dark-800 p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
            <div class="bg-primary-100 dark:bg-primary-900/30 p-3 rounded-full w-12 h-12 flex items-center justify-center mb-4 mx-auto">
              <i class="bi bi-mortarboard-fill text-primary-500 dark:text-primary-400 text-xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Undergraduate Scholarships</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
              Explore a wide range of scholarships available for undergraduate students across various fields of study.
            </p>
            <a href="#apply-now" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 font-semibold inline-flex items-center">
              Learn More <i class="bi bi-arrow-right ml-1"></i>
            </a>
          </div>

          <div class="bg-white dark:bg-dark-800 p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
            <div class="bg-primary-100 dark:bg-primary-900/30 p-3 rounded-full w-12 h-12 flex items-center justify-center mb-4 mx-auto">
              <i class="bi bi-book-half text-primary-500 dark:text-primary-400 text-xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Postgraduate Scholarships</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
              We assist postgraduate students in identifying scholarships and grants to further their academic and research endeavors.
            </p>
            <a href="#apply-now" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 font-semibold inline-flex items-center">
              Learn More <i class="bi bi-arrow-right ml-1"></i>
            </a>
          </div>

          <div class="bg-white dark:bg-dark-800 p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
            <div class="bg-primary-100 dark:bg-primary-900/30 p-3 rounded-full w-12 h-12 flex items-center justify-center mb-4 mx-auto">
              <i class="bi bi-globe2 text-primary-500 dark:text-primary-400 text-xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">International Scholarships</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
              Our team provides detailed guidance on securing international scholarships to study abroad.
            </p>
            <a href="#apply-now" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400 font-semibold inline-flex items-center">
              Learn More <i class="bi bi-arrow-right ml-1"></i>
            </a>
          </div>
        </div>
      </div>
    </section>

    <section class="py-16">
      <div class="container mx-auto px-4">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white text-center mb-12">Available Scholarship Documents</h2>
        <div id="scholarship-documents" class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
          <!-- Documents loaded via JS -->
        </div>
      </div>
    </section>

    <section id="application-form" class="py-16 bg-gray-50 dark:bg-dark-900">
      <div class="container mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-primary-500 mb-4">Scholarship Application Form</h2>
          <p class="text-lg text-gray-600 dark:text-gray-400">Fill in the form below to apply for available scholarship opportunities.</p>
        </div>

        <form id="scholarshipForm" class="max-w-3xl mx-auto bg-white dark:bg-dark-800 p-8 rounded-lg shadow-lg border-l-4 border-primary-500" enctype="multipart/form-data" novalidate>
          <!-- Hidden input for scholarship_id if needed -->
          <input type="hidden" name="scholarship_id" id="scholarship_id" value="1">

          <!-- Step 1: Personal Information -->
          <div class="form-step" id="step-1">
            <div class="mb-6 flex flex-col items-center">
              <label for="profilePicture" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Profile Picture</label>
              <div id="profileUploadArea" class="relative flex flex-col items-center justify-center w-32 h-32 rounded-full border-2 border-dashed border-primary-500 dark:border-primary-400 bg-gray-100 dark:bg-dark-900 cursor-pointer transition hover:bg-primary-50 dark:hover:bg-primary-900/20 mb-2">
                <img id="profilePreview" class="absolute w-32 h-32 rounded-full object-cover hidden z-10" alt="Profile Preview">
                <div id="profilePlaceholder" class="flex flex-col items-center justify-center h-full w-full z-0">
                  <i class="fas fa-user-circle text-6xl text-gray-300 dark:text-white"></i>
                  <span class="text-xs text-gray-500 dark:text-gray-400 mt-1">Drag & drop or click</span>
                </div>
                <input type="file" id="profilePicture" name="profile_picture_url" accept="image/*" class="absolute inset-0 opacity-0 cursor-pointer w-full h-full" required>
              </div>
              <button type="button" id="profileUploadBtn" class="mt-2 px-4 py-2 bg-primary-500 text-white rounded shadow hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-500">Choose Photo</button>
              <span class="text-xs text-gray-500 dark:text-gray-400 mt-1">Max size: 2MB. JPG, PNG, or GIF.</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label for="fullName" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Full Name</label>
                <input type="text" id="fullName" name="full_name" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. Jane Doe" required>
              </div>
              <div>
                <label for="emailAddress" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Email Address</label>
                <input type="email" id="emailAddress" name="email_address" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. jane@email.com" required>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label for="dob" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Date of Birth</label>
                <input type="date" id="dob" name="date_of_birth" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" required>
              </div>
              <div>
                <label for="gender" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Gender</label>
                <select id="gender" name="gender" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" required>
                  <option value="">Select gender</option>
                  <option value="female">Female</option>
                  <option value="male">Male</option>
                  <option value="other">Other</option>
                </select>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label for="phone" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Phone Number</label>
                <input type="tel" id="phone" name="phone_number" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. +250 123 456 789" required>
              </div>
              <div>
                <label for="address" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Address</label>
                <input type="text" id="address" name="address" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. 123 Main St, Kigali" required>
              </div>
            </div>
            <div class="flex justify-end">
              <button type="button" class="next-step bg-primary-500 text-white px-8 py-3 rounded font-semibold hover:bg-primary-600 transition-all duration-300">Next</button>
            </div>
          </div>

          <!-- Step 2: Academic Information -->
          <div class="form-step hidden" id="step-2">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label for="preferredUniversity" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Preferred University</label>
                <select id="preferredUniversity" name="preferred_university" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" required>
                  <option value="">Select a university</option>
                  <!-- Options will be populated by JS -->
                </select>
                
              </div>
              <div>
                <label for="country" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Country</label>
                <select id="country" name="country" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" required>
                  <option value="">Select a country</option>
                </select>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label for="academicLevel" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Academic Level</label>
                <select id="academicLevel" name="academic_level" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" required>
                  <option value="">Select level</option>
                  <option value="undergraduate">Undergraduate</option>
                  <option value="graduate">Graduate</option>
                  <option value="phd">PhD</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label for="intendedMajor" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Intended Major/Field of Study</label>
                <input type="text" id="intendedMajor" name="intended_major" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. Computer Science">
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label for="gpa" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">GPA / Academic Performance</label>
                <input type="text" id="gpaAcademicPerformance" name="gpa_academic_performance" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. 3.8/4.0">
              </div>
              <div>
                <label for="documents" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Upload Documents</label>
                <input type="file" id="documents" name="uploaded_documents_json" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" multiple>
              </div>
            </div>
            <div class="mb-6">
              <label for="extracurriculars" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Extracurricular Activities</label>
              <textarea id="extracurricularActivities" name="extracurricular_activities" rows="2" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="List your activities, clubs, sports, etc."></textarea>
            </div>
            <div class="flex justify-between">
              <button type="button" class="prev-step bg-gray-300 text-gray-700 px-8 py-3 rounded font-semibold hover:bg-gray-400 transition-all duration-300">Back</button>
              <button type="button" class="next-step bg-primary-500 text-white px-8 py-3 rounded font-semibold hover:bg-primary-600 transition-all duration-300">Next</button>
            </div>
          </div>

          <!-- Step 3: Additional Information -->
          <div class="form-step hidden" id="step-3">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label for="parentName" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Parent/Guardian Name</label>
                <input type="text" id="parentGuardianName" name="parent_guardian_name" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. John Doe">
              </div>
              <div>
                <label for="parentContact" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Parent/Guardian Contact</label>
                <input type="text" id="parentGuardianContact" name="parent_guardian_contact" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. +250 987 654 321">
              </div>
            </div>
            <div class="mb-6">
              <label for="financialNeed" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Financial Need Statement</label>
              <textarea id="financialNeedStatement" name="financial_need_statement" rows="3" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="Describe your financial situation and why you need this scholarship."></textarea>
            </div>
            <div class="mb-6">
              <label for="referral" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">How did you hear about this scholarship?</label>
              <input type="text" id="howHeardAbout" name="how_heard_about" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="e.g. School, Social Media, Friend">
            </div>
            <!-- Scholarship Type removed: admin uses Preferred University to determine scholarship_id -->
            <div class="mb-6">
              <label for="message" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">Why Are You Applying?</label>
              <textarea id="motivationStatement" name="motivation_statement" rows="4" class="w-full px-4 py-2 border dark:border-gray-700 rounded focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-dark-900" placeholder="Briefly explain your motivation..."></textarea>
            </div>
            <div class="mb-6">
              <label class="inline-flex items-center">
                <input type="checkbox" name="terms_agreed" required>
                <span class="ml-2 text-gray-700 dark:text-gray-300">I agree to the terms and conditions</span>
              </label>
            </div>
            <div class="flex justify-between">
              <button type="button" class="prev-step bg-gray-300 text-gray-700 px-8 py-3 rounded font-semibold hover:bg-gray-400 transition-all duration-300">Back</button>
              <button type="submit" class="bg-primary-500 text-white px-8 py-3 rounded font-semibold hover:bg-primary-600 transition-all duration-300">Submit Application</button>
            </div>
          </div>
        </form>
      </div>
    </section>
  </main>

  <footer class="bg-gray-800 dark:bg-dark-900 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <a href="home.html" class="text-2xl font-bold dark:text-white">MBAPE</a>
          <div class="mt-4 text-gray-300 dark:text-gray-400">
            <p>Remera-Gisimenti</p>
            <p>Remera-Gisimenti, equity bank 2nd floor</p>
            <p class="mt-3"><strong>Phone:</strong> <span>+1(431) 309-2173</span></p>
            <p><strong>Email:</strong> <span>reaglegroup8@gmail.com</span></p>
          </div>
          <div class="flex space-x-4 mt-4">
            <a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400"><i class="bi bi-twitter-x"></i></a>
            <a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400"><i class="bi bi-facebook"></i></a>
            <a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400"><i class="bi bi-instagram"></i></a>
            <a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400"><i class="bi bi-linkedin"></i></a>
          </div>
        </div>

        <div>
          <h4 class="text-xl font-semibold mb-4 dark:text-white">Useful Links</h4>
          <ul class="space-y-2">
            <li><a href="home.html" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Home</a></li>
            <li><a href="about.html" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">About us</a></li>
            <li><a href="service.html" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Services</a></li>
            <li><a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Terms of service</a></li>
            <li><a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Privacy policy</a></li>
          </ul>
        </div>

        <div>
          <h4 class="text-xl font-semibold mb-4 dark:text-white">Our Services</h4>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Web Design</a></li>
            <li><a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Web Development</a></li>
            <li><a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Crypto Assistance</a></li>
            <li><a href="scholarship.html" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Scholarships Consultancy</a></li>
            <li><a href="#" class="text-gray-300 hover:text-primary-500 dark:hover:text-primary-400">Visa Assistance</a></li>
          </ul>
        </div>

        <div>
          <h4 class="text-xl font-semibold mb-4 dark:text-white">Our Newsletter</h4>
          <p class="mb-4 text-gray-300 dark:text-gray-400">Subscribe to our newsletter and receive the latest news about our services!</p>
          <form class="space-y-4">
            <input type="email" class="w-full px-4 py-2 rounded text-gray-800 dark:bg-gray-700 dark:text-white" placeholder="Your Email">
            <button type="submit" class="w-full bg-primary-500 text-white px-4 py-2 rounded hover:bg-primary-600 transition-all duration-300">Subscribe</button>
          </form>
        </div>
      </div>

      <div class="text-center mt-8 pt-8 border-t border-gray-700 text-gray-300 dark:text-gray-400">
        <p>© <span>Copyright</span> <strong class="px-1 dark:text-white">MBAPE GLOBAL</strong> <span>All Rights Reserved</span></p>
      </div>
    </div>
  </footer>

  <a href="#" id="scroll-top" class="fixed bottom-8 right-8 bg-primary-500 text-white p-3 rounded-full hover:bg-primary-600 transition-all duration-300 hidden shadow-lg">
    <i class="bi bi-arrow-up-short"></i>
  </a>

  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>

  <script src="assets/js/main.js"></script>

  <script src="js/logout-utility.js"></script>
  <script src="js/include-navbar.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      includeNavbar(); // Load and initialize the navbar
    });

    // Scroll Top Button (kept here as it's page-specific functionality)
    const scrollTopBtn = document.getElementById("scroll-top");

    window.addEventListener("scroll", () => {
      if (window.scrollY > 200) {
        scrollTopBtn.classList.remove("hidden");
      } else {
        scrollTopBtn.classList.add("hidden");
      }
    });

    scrollTopBtn.addEventListener("click", (e) => {
      e.preventDefault();
      window.scrollTo({
        top: 0,
        behavior: "smooth"
      });
    });

    // Multi-step form logic
    const steps = Array.from(document.querySelectorAll('.form-step'));
    let currentStep = 0;

    function showStep(index) {
      steps.forEach((step, i) => {
        step.classList.toggle('hidden', i !== index);
      });
    }

    // Validate current step before advancing
    function validateStep(stepIndex) {
      const stepEl = steps[stepIndex];
      const required = Array.from(stepEl.querySelectorAll('[required]'));
      for (const el of required) {
        if (!el.checkValidity()) {
          displayMessageBox(`Please complete ${labelFor(el)}.`, 'error');
          navigateToField(el);
          return false;
        }
      }
      return true;
    }

    document.querySelectorAll('.next-step').forEach(btn => {
      btn.addEventListener('click', () => {
        if (!validateStep(currentStep)) return;
        if (currentStep < steps.length - 1) {
          currentStep++;
          showStep(currentStep);
        }
      });
    });

    document.querySelectorAll('.prev-step').forEach(btn => {
      btn.addEventListener('click', () => {
        if (currentStep > 0) {
          currentStep--;
          showStep(currentStep);
        }
      });
    });

    showStep(currentStep);

    // Countries list (mirror admin applications page)
    const countries = [
      "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "Armenia", "Australia", "Austria", "Azerbaijan", "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus", "Belgium", "Belize", "Benin", "Bhutan", "Bolivia", "Bosnia and Herzegovina", "Botswana", "Brazil", "Brunei", "Bulgaria", "Burkina Faso", "Burundi", "Cabo Verde", "Cambodia", "Cameroon", "Canada", "Central African Republic", "Chad", "Chile", "China", "Colombia", "Comoros", "Congo", "Costa Rica", "Croatia", "Cuba", "Cyprus", "Czech Republic", "Denmark", "Djibouti", "Dominica", "Dominican Republic", "Ecuador", "Egypt", "El Salvador", "Equatorial Guinea", "Eritrea", "Estonia", "Eswatini", "Ethiopia", "Fiji", "Finland", "France", "Gabon", "Gambia", "Georgia", "Germany", "Ghana", "Greece", "Grenada", "Guatemala", "Guinea", "Guinea-Bissau", "Guyana", "Haiti", "Honduras", "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq", "Ireland", "Israel", "Italy", "Jamaica", "Japan", "Jordan", "Kazakhstan", "Kenya", "Kiribati", "Kuwait", "Kyrgyzstan", "Laos", "Latvia", "Lebanon", "Lesotho", "Liberia", "Libya", "Liechtenstein", "Lithuania", "Luxembourg", "Madagascar", "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands", "Mauritania", "Mauritius", "Mexico", "Micronesia", "Moldova", "Monaco", "Mongolia", "Montenegro", "Morocco", "Mozambique", "Myanmar", "Namibia", "Nauru", "Nepal", "Netherlands", "New Zealand", "Nicaragua", "Niger", "Nigeria", "North Korea", "North Macedonia", "Norway", "Oman", "Pakistan", "Palau", "Palestine", "Panama", "Papua New Guinea", "Paraguay", "Peru", "Philippines", "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda", "Saint Kitts and Nevis", "Saint Lucia", "Saint Vincent and the Grenadines", "Samoa", "San Marino", "Sao Tome and Principe", "Saudi Arabia", "Senegal", "Serbia", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia", "Solomon Islands", "Somalia", "South Africa", "South Korea", "South Sudan", "Spain", "Sri Lanka", "Sudan", "Suriname", "Sweden", "Switzerland", "Syria", "Taiwan", "Tajikistan", "Tanzania", "Thailand", "Timor-Leste", "Togo", "Tonga", "Trinidad and Tobago", "Tunisia", "Turkey", "Turkmenistan", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States", "Uruguay", "Uzbekistan", "Vanuatu", "Vatican City", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe"
    ];

    function populateCountriesPublic() {
      const countrySelect = document.getElementById('country');
      if (!countrySelect) return;
      const current = countrySelect.value;
      countrySelect.innerHTML = '<option value="">Select a country</option>';
      countries.forEach(country => {
        const option = document.createElement('option');
        option.value = country;
        option.textContent = country;
        countrySelect.appendChild(option);
      });
      if (current) countrySelect.value = current;
    }

    // Load scholarship documents
    (async function loadScholarshipDocuments(){
      try {
        const container = document.getElementById('scholarship-documents');
        if (!container) return;
        container.innerHTML = `<div class="col-span-full text-center text-gray-500 dark:text-gray-400">Loading documents...</div>`;
        const resp = await fetch('/api/scholarship-documents');
        const data = await resp.json();
        const docs = data && data.success ? (data.documents || []) : [];
        if (!docs.length) {
          container.innerHTML = `<div class="col-span-full text-center text-gray-500 dark:text-gray-400">No documents available yet.</div>`;
          return;
        }
        container.innerHTML = docs.map(d => `
          <div class="bg-white dark:bg-dark-800 p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300">
            <div class="flex items-start">
              <div class="bg-primary-100 dark:bg-primary-900/30 p-3 rounded-lg mr-4">
                <i class="bi bi-file-earmark-pdf-fill text-primary-500 dark:text-primary-400 text-2xl"></i>
              </div>
              <div>
                <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-1">${d.title || 'Document'}</h3>
                <p class="text-gray-600 dark:text-gray-400 mb-4">${d.description || ''}</p>
                <a href="/api/scholarship-documents/download/${d.id}" class="inline-block bg-primary-500 text-white px-6 py-2 rounded hover:bg-primary-600 transition-all duration-300 flex items-center">
                  <i class="bi bi-download mr-2"></i> Download (${(Number(d.file_size)||0) ? (Math.ceil(Number(d.file_size)/1024)+' KB') : 'PDF'})
                </a>
              </div>
            </div>
          </div>
        `).join('');
      } catch (e) {
        const container = document.getElementById('scholarship-documents');
        if (container) container.innerHTML = `<div class="col-span-full text-center text-red-500">Failed to load documents.</div>`;
      }
    })();

    // Enhanced Profile Picture Upload
    const profileInput = document.getElementById('profilePicture');
    const profilePreview = document.getElementById('profilePreview');
    const profilePlaceholder = document.getElementById('profilePlaceholder');
    const profileUploadArea = document.getElementById('profileUploadArea');
    const profileUploadBtn = document.getElementById('profileUploadBtn');

    profileUploadBtn.addEventListener('click', () => profileInput.click());

    profileInput.addEventListener('change', function(event) {
      const [file] = event.target.files;
      if (file) {
        if (!file.type.startsWith('image/')) {
          alert('Please select a valid image file.');
          profileInput.value = '';
          return;
        }
        if (file.size > 2 * 1024 * 1024) {
          alert('Image size must be less than 2MB.');
          profileInput.value = '';
          return;
        }
        profilePreview.src = URL.createObjectURL(file);
        profilePreview.classList.remove('hidden');
        profilePlaceholder.classList.add('hidden');
      } else {
        profilePreview.src = '';
        profilePreview.classList.add('hidden');
        profilePlaceholder.classList.remove('hidden');
      }
    });

    // Drag & Drop support
    profileUploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      profileUploadArea.classList.add('ring-2', 'ring-primary-500');
    });
    profileUploadArea.addEventListener('dragleave', (e) => {
      e.preventDefault();
      profileUploadArea.classList.remove('ring-2', 'ring-primary-500');
    });
    profileUploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      profileUploadArea.classList.remove('ring-2', 'ring-primary-500');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        profileInput.files = files;
        profileInput.dispatchEvent(new Event('change'));
      }
    });

    // Validate full form across steps and navigate to first error
    function findFirstInvalidField() {
      const requiredFields = Array.from(document.querySelectorAll('#scholarshipForm [required]'));
      return requiredFields.find(el => !el.checkValidity());
    }

    function labelFor(el) {
      const id = el.getAttribute('id');
      if (id) {
        const lbl = document.querySelector(`label[for="${id}"]`);
        if (lbl) return lbl.textContent.trim();
      }
      return el.name || 'a required field';
    }

    function navigateToField(el) {
      const stepEl = el.closest('.form-step');
      const idx = steps.indexOf(stepEl);
      if (idx >= 0) {
        currentStep = idx;
        showStep(currentStep);
      }
      // Focus after the step is visible
      setTimeout(() => {
        try { el.focus({ preventScroll: true }); } catch {}
        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        if (el.reportValidity) el.reportValidity();
      }, 50);
    }

    document.getElementById('scholarshipForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const form = e.target;

      // Client-side validation across steps
      const invalid = findFirstInvalidField();
      if (invalid) {
        displayMessageBox(`Please complete ${labelFor(invalid)}.`, 'error');
        navigateToField(invalid);
        return;
      }

      const formData = new FormData(form);
      const scholarshipId = form.querySelector('[name="scholarship_id"]').value;
      if (scholarshipId && !formData.has('scholarship_id')) formData.append('scholarship_id', scholarshipId);
      // Normalize checkbox value like admin
      if (form.querySelector('input[name="terms_agreed"]') && form.querySelector('input[name="terms_agreed"]').checked) {
        formData.set('terms_agreed', 'on');
      }
      try {
        const response = await fetch('/api/admin-dashboard/applications', { method: 'POST', body: formData });
        const result = await response.json();
        if (response.ok) {
          const score = (result && result.data && typeof result.data.suitability_percent === 'number') ? result.data.suitability_percent : null;
          const breakdown = (result && result.data && Array.isArray(result.data.suitability_breakdown)) ? result.data.suitability_breakdown : [];
          if (score !== null) {
            displayMessageBox(`Application submitted! Your match score is ${score}% for this scholarship.`, 'success');
            // Build actionable tips based on breakdown (admin logic weights)
            const byKey = Object.fromEntries(breakdown.map(b => [b.key, b.points]));
            const tips = [];
            if ((byKey.academic_level ?? 0) < 20) tips.push('Confirm Academic level matches the scholarship requirement.');
            if ((byKey.gpa ?? 0) < 25) tips.push('Improve or clearly state GPA to meet or exceed the minimum.');
            if ((byKey.field_of_study ?? 0) < 20) tips.push('Align Intended major with the scholarship’s field of study.');
            if ((byKey.country ?? 0) < 10) tips.push('Select the correct country or choose scholarships for your country.');
            if ((byKey.documents ?? 0) < 10) tips.push('Upload all required supporting documents.');
            if ((byKey.motivation ?? 0) < 10) tips.push('Strengthen your motivation statement (be specific and detailed).');
            if ((byKey.extracurricular ?? 0) < 5) tips.push('Add more extracurricular activities and leadership roles.');
            if (tips.length) {
              const msg = 'Recommended improvements to increase your selection chance:\n- ' + tips.join('\n- ');
              displayMessageBox(msg, 'info');
            }
          } else {
          displayMessageBox('Application submitted successfully!', 'success');
          }
          form.reset();
          // Return to first step after successful submission
          currentStep = 0;
          showStep(currentStep);
        } else {
          displayMessageBox('Error: ' + (result.message || result.error || 'Submission failed'), 'error');
        }
      } catch (error) {
        displayMessageBox('Network error: ' + error.message, 'error');
      }
    });

    // Mirror admin: populate universities and country options, and set scholarship_id
    (async function loadScholarshipsAndPopulateSelectsPublic(){
      try {
        const resp = await fetch('/api/scholarships');
        const scholarships = await resp.json();
        const universitySelect = document.getElementById('preferredUniversity');
        const scholarshipIdInput = document.getElementById('scholarship_id');
        const countrySelect = document.getElementById('country');

        // Universities
        if (universitySelect) {
          universitySelect.innerHTML = '<option value="">Select a university</option>';
          scholarships.forEach(s => {
            const opt = document.createElement('option');
            opt.value = s.name;
            opt.textContent = s.name;
            opt.dataset.scholarshipId = s.id;
            opt.dataset.country = s.country || '';
            universitySelect.appendChild(opt);
          });
          universitySelect.addEventListener('change', () => {
            const sel = universitySelect.options[universitySelect.selectedIndex];
            scholarshipIdInput.value = sel && sel.dataset.scholarshipId ? sel.dataset.scholarshipId : '';
            // Auto-set country like admin behavior
            if (countrySelect && sel && sel.dataset.country) {
              const targetCountry = sel.dataset.country;
              // ensure option exists
              let has = false;
              for (let i = 0; i < countrySelect.options.length; i++) {
                if (countrySelect.options[i].value === targetCountry) { has = true; break; }
              }
              if (!has && targetCountry) {
                const opt = document.createElement('option');
                opt.value = targetCountry;
                opt.textContent = targetCountry;
                countrySelect.appendChild(opt);
              }
              countrySelect.value = targetCountry;
            }
          });
        }

        // Countries: show full list like admin
        populateCountriesPublic();

        // Duplicate check like admin on email blur when scholarship selected
        const emailEl = document.getElementById('emailAddress');
        emailEl?.addEventListener('blur', async function(){
          const email = emailEl.value.trim();
          const id = scholarshipIdInput.value.trim();
          if (!email || !id) return;
          try {
            const r = await fetch(`/api/scholarships/${encodeURIComponent(id)}/has-applied?email=${encodeURIComponent(email)}`);
            const d = await r.json();
            if (d && d.hasApplied) alert('This email already applied for the selected scholarship.');
          } catch {}
        });
      } catch (e) {
        console.error('Failed to load scholarships for public form', e);
      }
    })();

    // Custom message box function (copied from partnership form for consistency)
    function displayMessageBox(message, type = 'info') {
        const messageBox = document.createElement('div');
        messageBox.className = `fixed top-4 right-4 p-4 rounded-md shadow-lg text-white z-[1001]`;
        
        if (type === 'success') {
            messageBox.classList.add('bg-green-500');
        } else if (type === 'error') {
            messageBox.classList.add('bg-red-500');
        } else {
            messageBox.classList.add('bg-blue-500');
        }

        messageBox.textContent = message;
        document.body.appendChild(messageBox);

        setTimeout(() => {
            messageBox.remove();
        }, 3000); // Message disappears after 3 seconds
    }

    document.addEventListener('DOMContentLoaded', async function() {
      // Fetch scholarships from backend
      const res = await fetch('/api/scholarships');
      const scholarships = await res.json();

      const select = document.getElementById('preferredUniversity');
      const hiddenId = document.getElementById('scholarship_id');
      const countryInput = document.getElementById('country');

      // Populate the select dropdown with only open scholarships
      scholarships.forEach(sch => {
                        if (sch.status === 'active') {
          const option = document.createElement('option');
          option.value = sch.name;
          option.textContent = `${sch.name} - $${sch.award_amount ? sch.award_amount.toLocaleString() : 'N/A'} (${sch.academic_level})`;
          option.dataset.scholarshipId = sch.id;
          option.dataset.country = sch.sponsor || '';
          option.dataset.amount = sch.award_amount || '';
          option.dataset.deadline = sch.application_deadline || '';
          select.appendChild(option);
        }
      });

      // When user selects a scholarship, update the hidden scholarship_id and country
      select.addEventListener('change', async function() {
        const selectedOption = select.options[select.selectedIndex];
        hiddenId.value = selectedOption.dataset.scholarshipId || '';
        countryInput.value = selectedOption.dataset.country || '';
        
        // Show scholarship details if available
        if (selectedOption.dataset.amount) {
          console.log(`Selected: ${selectedOption.textContent}`);
          console.log(`Amount: $${selectedOption.dataset.amount}`);
          console.log(`Deadline: ${selectedOption.dataset.deadline}`);
        }

        // Check if this email already applied for the selected scholarship
        const email = document.getElementById('emailAddress')?.value?.trim();
        if (hiddenId.value && email) {
          try {
            const resp = await fetch(`/api/scholarships/${encodeURIComponent(hiddenId.value)}/has-applied?email=${encodeURIComponent(email)}`);
            const data = await resp.json();
            if (data && data.hasApplied) {
              displayMessageBox('You have already applied for this scholarship with this email.', 'error');
            }
          } catch {}
        }
      });

      // Also check when email changes (if a scholarship is preselected)
      const emailEl = document.getElementById('emailAddress');
      emailEl?.addEventListener('blur', async function() {
        const email = emailEl.value.trim();
        const id = hiddenId.value;
        if (!email || !id) return;
        try {
          const resp = await fetch(`/api/scholarships/${encodeURIComponent(id)}/has-applied?email=${encodeURIComponent(email)}`);
          const data = await resp.json();
          if (data && data.hasApplied) {
            displayMessageBox('You have already applied for this scholarship with this email.', 'error');
          }
        } catch {}
      });
    });
  </script>
</body>

</html>
